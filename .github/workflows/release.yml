name: Build and Release

on:
  push:
    branches:
      - master
      - main
      - workflow-testing

jobs:
  build:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout code
        uses: actions/checkout@v3

      - name: Set up JDK
        uses: actions/setup-java@v3
        with:
          java-version: '21'
          distribution: 'adopt'

      - name: Build with Maven
        run: mvn clean package

      - name: Rename jar file
        run: mv target/docker-client.8.16.1-SNAPSHOT.jar target/DockerClient.jar

      - name: Release
        uses: marvinpinto/action-automatic-releases@latest
        with:
          repo_token: "${{ secrets.GITHUB_TOKEN }}"
          automatic_release_tag: "latest"
          title: "DockerClient"
          files: |
            target/DockerClient.jar